<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Oddech 9D — Wspólne sesje</title>
  <style>
    /* -------------------- Reset / podstawy -------------------- */
    :root{
      --accent-1: #7fb7e6; /* jasny błękit */
      --accent-2: #a9d6ff;
      --bg-light: #f7fbff;
      --card: #ffffff;
      --muted: #6b7280;
      --glass: rgba(255,255,255,0.6);
      --radius: 14px;
      --shadow: 0 6px 18px rgba(8,24,40,0.08);

      --dark-bg: #0f1724;
      --dark-surface: #111827;
      --dark-card: #0b1220;
      --dark-accent: #3b82f6;
      --text: #0b1220;
      --text-inverse: #e6eef9;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: linear-gradient(180deg,var(--bg-light), #eef8ff 60%);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:24px;
      transition:background 0.3s, color 0.3s;
    }

    /* Container */
    .app{
      max-width:1200px;
      margin:0 auto;
      display:grid;
      grid-template-columns: 360px 1fr 360px;
      gap:20px;
      align-items:start;
    }

    header{grid-column:1/4; display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:6px}
    .brand{display:flex; gap:12px; align-items:center}
    .logo{width:56px; height:56px; border-radius:12px; background:linear-gradient(135deg,var(--accent-2),var(--accent-1)); display:flex; align-items:center; justify-content:center; color:white; font-weight:700; box-shadow:var(--shadow)}
    h1{margin:0; font-size:1.25rem}
    p.lead{margin:0; color:var(--muted); font-size:0.95rem}

    /* Card */
    .card{background:var(--card); padding:16px; border-radius:var(--radius); box-shadow:var(--shadow)}
    .muted{color:var(--muted)}

    /* Left column (harmonogram, sesje) */
    .left .section+ .section{margin-top:16px}
    .session-item{display:flex; align-items:center; justify-content:space-between; padding:10px; border-radius:10px; margin-bottom:8px}
    .session-item .name{font-weight:600}
    .session-list{margin-top:8px}
    .btn{display:inline-flex; align-items:center; gap:8px; background:var(--accent-1); color:white; border:none; padding:10px 14px; border-radius:10px; cursor:pointer}
    .btn.secondary{background:transparent; color:var(--accent-1); border:1px solid rgba(127,183,230,0.25)}
    .small{font-size:0.9rem; padding:8px 10px}

    /* Center column (główny panel: harmonogram, czat) */
    .center-grid{display:grid; grid-template-rows:auto 1fr; gap:16px}
    .schedule{display:flex; flex-direction:column; gap:8px}
    .time-block{display:flex; gap:12px; align-items:flex-start}
    .time{font-weight:700; width:84px}
    .desc{flex:1}

    /* Chat */
    .chat-window{display:flex; flex-direction:column; height:520px}
    .messages{flex:1; overflow:auto; padding:12px; border-radius:10px; background:linear-gradient(180deg, rgba(250,253,255,0.6), rgba(245,250,255,0.6));}
    .msg{margin-bottom:10px}
    .from-agent{font-weight:600}
    .from-user{align-self:flex-end}
    .chat-controls{display:flex; gap:8px; margin-top:8px}
    .textarea{flex:1; min-height:44px; padding:8px; border-radius:10px; border:1px solid #e6eef9}

    /* Right column (panel zapisów) */
    .right .section+ .section{margin-top:16px}
    .signup-list{max-height:240px; overflow:auto}
    .user-row{display:flex; gap:8px; align-items:center; justify-content:space-between; padding:8px; border-radius:8px}

    /* Footer controls */
    .controls{display:flex; gap:10px; align-items:center}
    label.switch{display:inline-flex; align-items:center; gap:8px}

    /* Responsive */
    @media (max-width:1024px){
      .app{grid-template-columns:1fr; padding:12px}
      header{flex-direction:column; align-items:flex-start}
      .right{order:3}
      .left{order:2}
    }

    /* Dark theme */
    .dark{
      background: radial-gradient(1200px 600px at 10% 10%, rgba(30,41,59,0.6), rgba(6,9,15,0.9));
      color:var(--text-inverse);
    }
    .dark .card{background:linear-gradient(180deg,var(--dark-card), rgba(6,9,15,0.6)); box-shadow:none}
    .dark .logo{background:linear-gradient(135deg,var(--dark-accent), #1e293b)}
    .dark .messages{background:linear-gradient(180deg, rgba(8,12,20,0.6), rgba(10,15,25,0.6));}
    .dark .textarea{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--text-inverse)}
    .dark .btn{background:var(--dark-accent)}

    /* Subtle animations */
    .fade-in{animation:fadeIn 450ms ease both}
    @keyframes fadeIn{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none}}

    /* Iframe styles for embeds */
    iframe { width: 100%; border: none; min-height: 300px; }
    @media (max-width: 600px) { iframe { min-height: 200px; } }

  </style>
</head>
<body>

  <div class="app" id="app">

    <header>
      <div class="brand">
        <div class="logo">9D</div>
        <div>
          <h1>Oddech 9D — Wspólne sesje</h1>
          <p class="lead">Harmonogram i zapisy — styl Techniki Uwalniania (David R. Hawkins). Neutralnie. Empatycznie.</p>
        </div>
      </div>

      <div class="controls">
        <label class="switch">
          <input id="themeToggle" type="checkbox" aria-label="Przełącz motyw" />
          <span class="muted">Tryb ciemny</span>
        </label>
        <button class="btn secondary small" id="exportCsv">Eksportuj listę CSV</button>
      </div>
    </header>

    <!-- LEWA KOLUMNA -->
    <aside class="left">
      <div class="card section fade-in">
        <h3>Harmonogram sesji</h3>
        <!-- Embed Google Calendar -->
        <iframe src="https://calendar.google.com/calendar/embed?src=TWOJ_KALENDARZ_ID%40group.calendar.google.com&ctz=Europe%2FWarsaw" style="border: 0" width="100%" height="400" frameborder="0" scrolling="no"></iframe>
      </div>

      <div class="card section fade-in">
        <h3>Dostępne sesje</h3>
        <div class="session-list" id="sessionList">
          <!-- dynamicznie wypełniane -->
        </div>
        <small class="muted">Sesje odbywają się co tydzień. Możesz także zaproponować inny dzień/godzinę.</small>
      </div>

      <div class="card section fade-in">
        <h3>Zasady grupy</h3>
        <p class="muted">Neutralność i słuchanie. Nie oceniamy. Szanujemy poufność. Sesje nie zastępują pomocy medycznej ani psychologicznej.</p>
      </div>
    </aside>

    <!-- ŚRODEK -->
    <main class="center">
      <div class="center-grid">

        <div class="card fade-in">
          <h3>Aktualna sesja</h3>
          <div style="display:flex; gap:12px; align-items:center; margin-top:8px">
            <div style="flex:1">
              <div id="currentSessionTitle" style="font-weight:700">Brak zaplanowanej sesji</div>
              <div class="muted" id="currentSessionInfo">Wybierz sesję i zapisz się, aby dołączyć.</div>
            </div>
            <div style="display:flex; gap:8px">
              <button class="btn small" id="joinBtn">Dołącz</button>
              <button class="btn secondary small" id="proposeBtn">Zaproponuj inny termin</button>
            </div>
          </div>
        </div>

        <div class="card chat-window fade-in" aria-live="polite">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
            <div>
              <strong>Komentarze i dyskusja</strong>
              <div class="muted">Dodaj komentarz poniżej. Lista komentarzy poniżej formularza.</div>
            </div>
          </div>

          <!-- Embed Google Forms dla komentarzy -->
          <iframe src="TWOJ_FORM_KOMENTARZE_URL" width="100%" height="300" frameborder="0" marginheight="0" marginwidth="0">Ładowanie…</iframe>

          <!-- Embed Google Sheets dla listy komentarzy -->
          <div class="messages" id="commentsList">
            <iframe src="TWOJ_SHEETS_KOMENTARZE_URL" width="100%" height="200" frameborder="0"></iframe>
          </div>

        </div>

      </div>
    </main>

    <!-- PRAWA KOLUMNA -->
    <aside class="right">
      <div class="card section fade-in">
        <h3>Zapisy na sesję</h3>
        <!-- Embed Google Forms dla zapisów -->
        <iframe src="TWOJ_FORM_ZAPISY_URL" width="100%" height="400" frameborder="0" marginheight="0" marginwidth="0">Ładowanie…</iframe>

        <div style="margin-top:12px">
          <strong>Lista zapisanych</strong>
          <!-- Embed Google Sheets dla listy zapisanych -->
          <div class="signup-list" id="signupList">
            <iframe src="TWOJ_SHEETS_ZAPISY_URL" width="100%" height="200" frameborder="0"></iframe>
          </div>
        </div>
      </div>

      <div class="card section fade-in">
        <h3>Panel moderatora (opcjonalny)</h3>
        <p class="muted">Zatwierdzaj propozycje terminów i zarządzaj harmonogramem w Google Calendar/Sheets.</p>
        <div id="proposals"></div>
      </div>

    </aside>

  </div>

  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    /*************************************************************************
     * Dane startowe i ustawienia
     *************************************************************************/
    const SESSIONS = [
      'Obfitość', 'Stres i niepokój', 'Przebudzenie', 'Przekraczanie strachu',
      'Ponowne połączenie ze swoim wewnętrznym dzieckiem', 'Podążaj za ciałem',
      'Połączenie ze źródłem', 'Regeneracja i relaks', 'Odpuszczenie i ruszenie dalej',
      'Uzdrowienie 5 Podstawowych Śladów Traumy', 'Traumy międzypokoleniowe', 'Pełny Reset'
    ];

    // Elementy DOM
    const sessionListEl = document.getElementById('sessionList');
    const currentSessionTitle = document.getElementById('currentSessionTitle');
    const currentSessionInfo = document.getElementById('currentSessionInfo');
    const themeToggle = document.getElementById('themeToggle');
    const joinBtn = document.getElementById('joinBtn');
    const proposeBtn = document.getElementById('proposeBtn');

    // Inicjalizacja listy sesji
    function initSessions(){
      sessionListEl.innerHTML = '';
      SESSIONS.forEach((s,i)=>{
        const div = document.createElement('div'); div.className='session-item';
        div.innerHTML = `<div><div class="name">${i+1}. ${s}</div><div class="muted">Tematyczna sesja oddechowa</div></div>`;
        sessionListEl.appendChild(div);
      });
    }

    // Aktualizacja aktualnej sesji z Google Calendar API (opcjonalne, jeśli używasz API)
    function updateCurrentSessionDisplay(){
      gapi.load('client', () => {
        gapi.client.init({
          apiKey: 'TWOJ_API_KEY', // Zastąp swoim API Key
          discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest']
        }).then(() => {
          gapi.client.calendar.events.list({
            calendarId: 'TWOJ_KALENDARZ_ID@group.calendar.google.com',
            timeMin: new Date().toISOString(),
            maxResults: 1,
            singleEvents: true,
            orderBy: 'startTime'
          }).then(response => {
            const events = response.result.items;
            if (events.length > 0) {
              currentSessionTitle.textContent = events[0].summary;
              currentSessionInfo.textContent = `Start: ${new Date(events[0].start.dateTime).toLocaleString()} • Opis: ${events[0].description || ''}`;
            } else {
              currentSessionTitle.textContent = 'Brak zaplanowanej sesji';
              currentSessionInfo.textContent = 'Wybierz sesję i zapisz się, aby dołączyć.';
            }
          });
        });
      });
    }

    // Dołącz — symulacja dołączenia do aktualnej sesji
    joinBtn.addEventListener('click', ()=>{
      alert('Dołączasz do sesji. Link do nagrania dostępny w Twoich materiałach.');
    });
    proposeBtn.addEventListener('click', ()=>{ alert('Zaproponuj termin w formularzu zapisów.'); });

    // Theme
    themeToggle.addEventListener('change', e=>{
      document.body.classList.toggle('dark', e.target.checked);
    });

    // Initial render
    initSessions();
    updateCurrentSessionDisplay();

  </script>
</body>
</html>
