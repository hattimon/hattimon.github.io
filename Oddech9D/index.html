<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oddech 9D - Wspólne Sesje</title>
    <style>
        /* CSS: Podstawowe style, motywy jasny i ciemny */
        :root {
            --bg-color: #f0f8ff; /* Jasny: miękka biel z nutą błękitu */
            --text-color: #333333;
            --accent-color: #add8e6; /* Łagodny błękit */
            --secondary-bg: #ffffff;
            --border-color: #d3d3d3;
            --button-bg: #add8e6;
            --button-text: #ffffff;
            --gradient: linear-gradient(135deg, #add8e6, #ffffff);
        }

        body.dark {
            --bg-color: #1e1e2f; /* Ciemny: głęboki granatowo-grafitowy */
            --text-color: #e0e0e0;
            --accent-color: #4682b4; /* Akcent błękitu */
            --secondary-bg: #2a2a3d;
            --border-color: #444455;
            --button-bg: #4682b4;
            --button-text: #ffffff;
            --gradient: linear-gradient(135deg, #4682b4, #2a2a3d);
        }

        body {
            font-family: 'Arial', sans-serif; /* Humanistyczna czcionka - można zastąpić np. 'Roboto' */
            background: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
            transition: background 0.3s, color 0.3s;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: var(--secondary-bg);
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        h1, h2, h3 {
            color: var(--accent-color);
        }

        button {
            background: var(--button-bg);
            color: var(--button-text);
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        button:hover {
            background: darken(var(--button-bg), 10%);
        }

        .theme-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        /* Animacje: Delikatne fade-in i oddechowe gradienty */
        @keyframes breathe {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .animated-bg {
            background: var(--gradient);
            background-size: 200% 200%;
            animation: breathe 10s ease infinite;
        }

        /* Czat style */
        #chat-window {
            height: 300px;
            overflow-y: scroll;
            border: 1px solid var(--border-color);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 10px;
            background: var(--bg-color);
        }

        .message {
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 10px;
        }

        .user-message {
            background: var(--accent-color);
            color: #fff;
            text-align: right;
        }

        .agent-message {
            background: var(--secondary-bg);
            color: var(--text-color);
        }

        /* Responsywność */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            button {
                width: 100%;
                margin-bottom: 10px;
            }
        }

        /* Dostępność: Kontrast i duże teksty */
        body {
            font-size: 16px; /* Bazowy rozmiar dla dostępności */
        }

        a, button {
            outline: none; /* Dla focus */
        }

        a:focus, button:focus {
            outline: 2px solid var(--accent-color);
        }
    </style>
</head>
<body class="animated-bg">
    <div class="theme-switcher">
        <button onclick="toggleTheme()">Przełącz motyw</button>
    </div>

    <div class="container">
        <h1>Witaj w grupie „Oddech 9D”</h1>
        <p>To przestrzeń dla Ciebie, po ukończeniu 12-tygodniowego programu. Tutaj możesz znaleźć motywację do wspólnych sesji oddechowych. Pamiętaj, że te sesje nie zastępują profesjonalnej pomocy medycznej lub psychologicznej. Jeśli potrzebujesz wsparcia, skonsultuj się ze specjalistą.</p>

        <!-- Sekcja: Zasady grupy -->
        <section id="rules">
            <h2>Zasady grupy</h2>
            <ul>
                <li>Bądź neutralny i szanuj innych – bez oceniania.</li>
                <li>Zachowaj poufność – to, co dzielisz, zostaje w grupie.</li>
                <li>Obserwuj swoje uczucia bez osądu, zgodnie z Techniką Uwalniania.</li>
            </ul>
        </section>

        <!-- Sekcja: Harmonogram standardowy -->
        <section id="schedule">
            <h2>Harmonogram spotkania</h2>
            <ul>
                <li>18:30 – "Czas dla Was": dzielenie się doświadczeniami, pytania i rozmowa z AI agentem / między uczestnikami.</li>
                <li>19:00 – Rozpoczęcie i przygotowanie do sesji.</li>
                <li>~19:45 – Start sesji oddechowej (uczestnicy słuchają nagrań na słuchawkach).</li>
                <li>~21:00 – Zakończenie, dzielenie się wrażeniami, zadanie domowe.</li>
            </ul>
            <p>Sesja trwa około godziny, czasami dłużej (do 1:10–1:20).</p>
        </section>

        <!-- Sekcja: Lista sesji do wyboru -->
        <section id="sessions">
            <h2>Lista sesji do wyboru</h2>
            <select id="session-select">
                <option value="1">1. Obfitość</option>
                <option value="2">2. Stres i niepokój</option>
                <option value="3">3. Przebudzenie</option>
                <option value="4">4. Przekraczanie strachu</option>
                <option value="5">5. Ponowne połączenie ze swoim wewnętrznym dzieckiem</option>
                <option value="6">6. Podążaj za ciałem</option>
                <option value="7">7. Połączenie ze źródłem</option>
                <option value="8">8. Regeneracja i relaks</option>
                <option value="9">9. Odpuszczenie i ruszenie dalej</option>
                <option value="10">10. Uzdrowienie 5 Podstawowych Śladów Traumy</option>
                <option value="11">11. Traumy międzypokoleniowe</option>
                <option value="12">12. Pełny Reset</option>
            </select>
        </section>

        <!-- Sekcja: Zapisy i kalendarz -->
        <section id="signup">
            <h2>Rezerwacja na sesję</h2>
            <form id="signup-form">
                <label for="name">Twoje imię:</label>
                <input type="text" id="name" required>
                <label for="date">Proponowana data (domyślnie wtorek):</label>
                <input type="date" id="date">
                <label for="time">Godzina:</label>
                <input type="time" id="time">
                <button type="submit">Zapisz się</button>
                <button type="button" onclick="suggestAlternative()">Zgłoś inny termin</button>
            </form>
            <h3>Lista zapisanych uczestników</h3>
            <ul id="participants-list"></ul>
            <button onclick="exportToCSV()">Eksportuj do CSV</button>
        </section>

        <!-- Sekcja: Czat grupowy -->
        <section id="chat">
            <h2>Czat grupowy</h2>
            <p>Czat dostępny 30 minut przed i po sesji. AI agent może być włączony dla wsparcia.</p>
            <div id="chat-window"></div>
            <input type="text" id="chat-input" placeholder="Napisz wiadomość...">
            <button onclick="sendMessage()">Wyślij</button>
            <button onclick="toggleAgent()">Włącz/Wyłącz AI Agenta</button>
            <button onclick="pauseAgent()">Pauza Agenta</button>
            <p>Przypomnienia: 1 godz. i 15 min. przed startem (symulowane w konsoli).</p>
        </section>

        <!-- Ostrzeżenie -->
        <footer>
            <p>Ostrzeżenie: Nie zapisujemy danych medycznych. Sesje to wsparcie grupowe, nie terapia.</p>
        </footer>
    </div>

    <script>
        // JS: Symulacja funkcjonalności (bez backendu)

        // Przełącznik motywu
        function toggleTheme() {
            document.body.classList.toggle('dark');
        }

        // Symulacja listy uczestników (użyj localStorage)
        let participants = JSON.parse(localStorage.getItem('participants')) || [];

        function updateParticipantsList() {
            const list = document.getElementById('participants-list');
            list.innerHTML = '';
            participants.forEach(p => {
                const li = document.createElement('li');
                li.textContent = `${p.name} - Sesja: ${p.session}, Data: ${p.date || 'Wtorek'}, Godzina: ${p.time || '18:30'}`;
                list.appendChild(li);
            });
        }

        // Formularz zapisu
        document.getElementById('signup-form').addEventListener('submit', e => {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const session = document.getElementById('session-select').options[document.getElementById('session-select').selectedIndex].text;
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            participants.push({ name, session, date, time });
            localStorage.setItem('participants', JSON.stringify(participants));
            updateParticipantsList();
            alert('Zapisano! Lista widoczna dla grupy.');
        });

        // Propozycja alternatywnego terminu (symulacja)
        function suggestAlternative() {
            alert('Propozycja wysłana do moderatora (symulacja).');
            // Tutaj: Podpięcie backendu - wysłać request do API moderatora
            // np. fetch('/api/suggest', { method: 'POST', body: JSON.stringify(data) });
        }

        // Eksport do CSV
        function exportToCSV() {
            let csv = 'Imię,Sesja,Data,Godzina\n';
            participants.forEach(p => {
                csv += `${p.name},${p.session},${p.date},${p.time}\n`;
            });
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'uczestnicy.csv';
            a.click();
        }

        // Czat: Symulacja
        let agentActive = false;
        let agentPaused = false;
        let agentInterval;

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value;
            if (message) {
                addMessage('user', 'Ty: ' + message);
                input.value = '';
                if (agentActive && !agentPaused) {
                    // Symulacja odpowiedzi agenta (klient-side)
                    setTimeout(() => {
                        const responses = [
                            'Co chciałbyś dziś podzielić się z grupą?',
                            'Co odczuwasz w ciele teraz?',
                            'Obserwuj to uczucie bez osądu. Co zauważasz?',
                            'Dziękuję za podzielenie się. Jak to wpływa na Ciebie?'
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        addMessage('agent', 'AI Agent: ' + randomResponse);
                    }, 1000);
                }
            }
        }

        function addMessage(type, text) {
            const window = document.getElementById('chat-window');
            const div = document.createElement('div');
            div.classList.add('message', type + '-message');
            div.textContent = text;
            window.appendChild(div);
            window.scrollTop = window.scrollHeight;
        }

        function toggleAgent() {
            agentActive = !agentActive;
            alert(agentActive ? 'AI Agent włączony' : 'AI Agent wyłączony');
            if (agentActive) {
                agentInterval = setInterval(() => {
                    if (!agentPaused) {
                        addMessage('agent', 'AI Agent: Jestem tutaj, aby słuchać. Co chciałbyś podzielić?');
                    }
                }, 30000); // Symulacja aktywności co 30s
            } else {
                clearInterval(agentInterval);
            }
        }

        function pauseAgent() {
            agentPaused = !agentPaused;
            alert(agentPaused ? 'AI Agent pauzowany' : 'AI Agent wznowiony');
        }

        // Symulacja przypomnień (w konsoli)
        console.log('Przypomnienie: 1 godz. przed sesją.');
        console.log('Przypomnienie: 15 min. przed sesją.');

        // Inicjalizacja
        updateParticipantsList();

        // KOMENTARZ: Podłączenie rzeczywistego API modelu językowego (np. OpenAI)
        // W funkcji sendMessage(), zamiast symulacji, użyj:
        // fetch('https://api.openai.com/v1/chat/completions', {
        //   method: 'POST',
        //   headers: { 'Authorization': 'Bearer YOUR_API_KEY', 'Content-Type': 'application/json' },
        //   body: JSON.stringify({
        //     model: 'gpt-4',
        //     messages: [{ role: 'system', content: 'Jesteś empatycznym agentem opartym na Technice Uwalniania Davida R. Hawkinsa. Bądź neutralny, słuchaj, zadawaj otwarte pytania.' },
        //                { role: 'user', content: message }]
        //   })
        // }).then(response => response.json()).then(data => {
        //   addMessage('agent', 'AI Agent: ' + data.choices[0].message.content);
        // });
        // Dodaj zarządzanie trybem czuwania: Jeśli sesja trwa (np. po 19:45), wyłącz interwencje agenta.

        // KOMENTARZ: Integracja powiadomień (webhook/cron)
        // Użyj service worker dla push notifications lub cron job na serwerze.
        // np. navigator.serviceWorker.register('/sw.js').then(reg => {
        //   reg.pushManager.subscribe({ userVisibleOnly: true, applicationServerKey: 'YOUR_KEY' });
        // });
        // Na backendzie: Użyj cron do wysyłania webhooków do klientów (np. via Firebase Cloud Messaging).

        // KOMENTARZ: Panel moderatora (opcjonalny)
        // Dodaj sekcję ukrytą, np. <section id="mod-panel" style="display:none;">...</section>
        // Pokazuj po logowaniu (symuluj localStorage 'isMod': true).
        // W realu: Autentykacja backendowa.

        // KOMENTARZ: Linki do nagrań
        // Dla każdego użytkownika, dodaj sekcję z placeholderami linków (np. <a href="user-specific-link">Twoje nagranie</a>)
        // Zarządzaj na backendzie, nie hostuj plików.

        // KOMENTARZ: Tryb czuwania agenta podczas sesji
        // Użyj timera: Po 19:45, agentPaused = true; Po 21:00, agentPaused = false;
    </script>
</body>
</html>
